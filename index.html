<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Digital Visiting Card - ‚Çπ499</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
font-family:'Inter',sans-serif;
background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
min-height:100vh;padding:20px}
.container{
width:100%;max-width:480px;margin:0 auto;background:white;
border-radius:24px;box-shadow:0 20px 60px rgba(0,0,0,0.3);overflow:hidden}
.header{
background:linear-gradient(135deg,#667eea,#764ba2);
padding:40px 24px;text-align:center;color:white}
.price-tag{
display:inline-block;background:linear-gradient(135deg,#FFD700,#FFA500);
color:#000;padding:16px 40px;border-radius:50px;
font-size:44px;font-weight:900;margin:16px 0}
.form-section{padding:28px 24px}
.section-header{
margin-bottom:18px;padding-bottom:14px;
border-bottom:3px solid #667eea;
font-size:17px;font-weight:700;color:#333}
.form-group{margin-bottom:18px}
.form-group label{display:block;margin-bottom:8px;font-weight:600}
.form-group input{
width:100%;padding:16px;border:2px solid #e2e8f0;
border-radius:12px;font-size:16px}
.form-group input:focus{
outline:none;border-color:#667eea;
box-shadow:0 0 0 4px rgba(102,126,234,0.1)}
.submit-btn{
width:100%;padding:20px;
background:linear-gradient(135deg,#667eea,#764ba2);
color:white;border:none;border-radius:16px;
font-size:18px;font-weight:700;cursor:pointer}
.submit-btn:disabled{opacity:.6;cursor:not-allowed}
.payment-msg,.success-msg{
display:none;margin-top:24px;padding:24px;border-radius:12px}
.payment-msg{background:#fff3cd;border-left:4px solid #f59e0b}
.success-msg{background:#d1fae5;border-left:4px solid #10b981}
.payment-msg.show,.success-msg.show{display:block}
.upi-id{
font-family:monospace;font-size:22px;
background:#f0fdf4;padding:12px;border-radius:8px;
margin:12px 0;font-weight:700;text-align:center}
.wa-btn{
display:inline-block;background:#25d366;color:white;
padding:14px 28px;border-radius:10px;text-decoration:none;
font-weight:700;margin-top:16px}
.loader-overlay{
position:fixed;inset:0;background:rgba(0,0,0,0.5);
display:flex;align-items:center;justify-content:center;
z-index:9999;display:none}
.loader-box{
background:white;padding:30px;border-radius:16px;
text-align:center;font-weight:600}
.error-box{
display:none;margin-top:20px;padding:16px;
background:#fee2e2;border-left:4px solid #dc2626;
border-radius:10px;color:#991b1b}
.error-box.show{display:block}
</style>
</head>

<body>

<div class="loader-overlay" id="loader">
<div class="loader-box">‚è≥ Processing...</div>
</div>

<div class="container">
<div class="header">
<h1>Professional Digital Visiting Card</h1>
<div class="price-tag">‚Çπ499</div>
<p>One-Time Payment ‚Ä¢ Lifetime Access</p>
</div>

<div class="form-section">

<form id="orderForm">

<div class="section-header">üìû Contact Details</div>

<div class="form-group">
<label>Full Name *</label>
<input type="text" name="fullName" required>
</div>

<div class="form-group">
<label>Email *</label>
<input type="email" name="email" id="emailField" required>
</div>

<div class="form-group">
<label>Phone *</label>
<input type="tel" name="phone" maxlength="10" required>
</div>

<div class="form-group">
<label>Business Name</label>
<input type="text" name="businessName">
</div>

<div class="form-group">
<label>Designation</label>
<input type="text" name="designation">
</div>

<button type="submit" class="submit-btn" id="submitBtn">
üìã Submit Order
</button>

<div class="error-box" id="errorBox"></div>

</form>

<div class="payment-msg" id="paymentMsg">
<h3>Payment Pending</h3>
<p>Pay ‚Çπ499 to UPI:</p>
<div class="upi-id">agrawalfuturify@ybl</div>
<a href="#" id="waLink" class="wa-btn">
üì± Send Screenshot on WhatsApp
</a>
</div>

<div class="success-msg" id="editSuccessMsg">
<h3>‚úÖ Card Updated Successfully</h3>
<a href="#" id="viewCardLink" class="wa-btn">üéØ View Card</a>
</div>

</div>
</div>

<script>
const WEB_APP_URL =https://script.google.com/macros/s/AKfycbw1t7VGkSoIlcbj90onKZCZp2vIXBekimPifeCHPJmFfcTlk0fXK4RV7srtWOpvNuFf/exec;

let isEditMode=false;
let currentEmail=null;

function showLoader(state){
document.getElementById('loader').style.display=state?'flex':'none';
}

function showError(msg){
const box=document.getElementById('errorBox');
box.innerText=msg;
box.classList.add('show');
}

function clearError(){
const box=document.getElementById('errorBox');
box.classList.remove('show');
}

async function safeFetch(url,options={},timeout=15000){
return Promise.race([
fetch(url,options),
new Promise((_,reject)=>
setTimeout(()=>reject(new Error("Request Timeout")),timeout))
]);
}

window.addEventListener('load',async()=>{
const params=new URLSearchParams(window.location.search);
const editEmail=params.get('email');
if(editEmail){
isEditMode=true;
currentEmail=editEmail;
document.getElementById('emailField').value=editEmail;
document.getElementById('emailField').disabled=true;
document.getElementById('submitBtn').textContent='‚úèÔ∏è Update Card';
try{
showLoader(true);
const response=await safeFetch(
`${WEB_APP_URL}?mode=fetch&email=${encodeURIComponent(editEmail)}`
);
if(!response.ok)throw new Error("Fetch failed");
const data=await response.json();
Object.keys(data).forEach(k=>{
if(k!=='email'){
const input=document.querySelector(`[name="${k}"]`);
if(input)input.value=data[k]||'';
}
});
}catch(err){
showError("Error loading data.");
}
showLoader(false);
}
});

document.getElementById('orderForm')
.addEventListener('submit',async function(e){

e.preventDefault();
clearError();

const formData=new FormData(this);
const data={};
formData.forEach((v,k)=>{
data[k]=isEditMode&&k==='email'?currentEmail:v;
});

if(!data.fullName||!data.email||!data.phone){
showError("Please fill required fields.");
return;
}

if(data.phone.length!==10){
showError("Phone must be 10 digits.");
return;
}

try{
showLoader(true);
const response=await safeFetch(WEB_APP_URL,{
method:'POST',
headers:{'Content-Type':'application/json'},
body:JSON.stringify(data)
});

if(!response.ok)throw new Error("Server Error");

const result=await response.json();
if(!result.success)throw new Error("Backend failure");

this.style.display='none';

if(isEditMode){
document.getElementById('editSuccessMsg')
.classList.add('show');
document.getElementById('viewCardLink').href=
`${WEB_APP_URL}?email=${encodeURIComponent(currentEmail)}`;
}else{
document.getElementById('paymentMsg')
.classList.add('show');
const waMsg=`Hi!
Digital Card Order

Name: ${data.fullName}
Email: ${data.email}
Phone: ${data.phone}

I have paid ‚Çπ499 to agrawalfuturify@ybl

Please verify and activate my card.`;

document.getElementById('waLink').href=
'https://wa.me/919770061597?text='+
encodeURIComponent(waMsg);
}

}catch(err){
showError("Error saving. Please try again.");
}
showLoader(false);
});

['phone'].forEach(name=>{
const input=document.querySelector(`[name="${name}"]`);
if(input){
input.addEventListener('input',function(){
this.value=this.value.replace(/[^0-9]/g,'')
.substring(0,10);
});
}
});
</script>

</body>
</html>
